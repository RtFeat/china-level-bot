from telebot import types
import time
import traceback
import os
import telebot
from dotenv import load_dotenv
import logging
from flask import Flask, render_template, request, jsonify
import threading

# –û—Ç–ª–∞–¥–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(name)s - %(levelname)s - %(message)s')
logger = logging.getLogger(__name__)

load_dotenv()
TOKEN = os.getenv("BOT_TOKEN")
if not TOKEN:
    TOKEN = input("–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞: ")
bot = telebot.TeleBot(TOKEN, parse_mode='HTML')

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
app = Flask(__name__)

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–ª–æ–≤–∞—Ä—å responses –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏
responses = {
    "–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏–∑ –ö–∏—Ç–∞—è": (
        "üí∞<b>–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏–∑ –ö–∏—Ç–∞—è</b>\n\n"
        " –°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞–ø—Ä—è–º—É—é –∑–∞–≤–∏—Å–∏—Ç –æ—Ç <i>–ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–∞!</i>\n\n"
        "–î–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –æ –≤–∞—à–µ–º —Ç–æ–≤–∞—Ä–µ:\n\n"
        "‚Ä¢ <b>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</b> (—Ö–æ–∑. —Ç–æ–≤–∞—Ä, –æ–¥–µ–∂–¥–∞, –æ–±—É–≤—å)\n"
        "‚Ä¢ <b>–í–µ—Å</b>, –∫–≥\n"
        "‚Ä¢ <b>–û–±—ä–µ–º</b>, –∫—É–±. –º.\n"
        "‚Ä¢ <b>–ì–∞–±–∞—Ä–∏—Ç—ã</b> (–¥–ª–∏–Ω–∞, —à–∏—Ä–∏–Ω–∞, –≤—ã—Å–æ—Ç–∞) ‚Äì –µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–µ–Ω –æ–±—ä–µ–º, —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –Ω–µ –∑–∞–ø–æ–ª–Ω—è—Ç—å.\n\n"
        "üìÑ –ù–∏–∂–µ –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º –Ω–∞—à –ø—Ä–∞–π—Å. –ó–Ω–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ (<i>–ø–ª–æ—Ç–Ω–æ—Å—Ç—å = –∫–≥/–∫—É–±. –º.</i>) –≤—ã –º–æ–∂–µ—Ç–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ —Ç–∞–±–ª–∏—Ü–µ.\n\n"
        "–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: –≤—Å–µ —Ç–æ–≤–∞—Ä—ã, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –æ–¥–µ–∂–¥—ã –∏ –æ–±—É–≤–∏, –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ —Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–º —Ç–æ–≤–∞—Ä–∞–º."
    ),
    "–£–ø–∞–∫–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π": (
        "üì¶<b>–£–ø–∞–∫–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π</b>\n\n"
        " –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ –†–æ—Å—Å–∏—é —Ç–æ–≤–∞—Ä –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–¥–µ–∂–Ω–æ —É–ø–∞–∫–æ–≤–∞—Ç—å. –ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —É–ø–∞–∫–æ–≤–∫–∏:\n\n"
        "‚Ä¢ –í–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º—ã–π –ø–∞–∫–µ—Ç + –¥–≤–æ–π–Ω–æ–π –º–µ—à–æ–∫ + –¥–≤–æ–π–Ω–æ–π —Å–∫–æ—Ç—á (–ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–∑–∫–∏ –º—è–≥–∫–∏—Ö, –Ω–µ —Ö—Ä—É–ø–∫–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤) ‚Äì *5$*\n"
        "‚Ä¢ –£—Å–∏–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ–Ω–Ω—ã–º–∏ —É–≥–æ–ª–∫–∞–º–∏ (–µ—Å–ª–∏ –≤–∞–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —É–ø–∞–∫–æ–≤–∫–∏) ‚Äì <i>6$/–º–µ—Å—Ç–æ, 0,3 –º¬≥</i>\n"
        "‚Ä¢ –£—Å–∏–ª–µ–Ω–∏–µ –¥–µ—Ä–µ–≤—è–Ω–Ω–æ–π –æ–±—Ä–µ—à–µ—Ç–∫–æ–π (–¥–ª—è —Ö—Ä—É–ø–∫–æ–≥–æ, –¥–æ—Ä–æ–≥–æ–≥–æ, –≥–∞–±–∞—Ä–∏—Ç–Ω–æ–≥–æ –≥—Ä—É–∑–∞) ‚Äì <i>8$/–º–µ—Å—Ç–æ, 0,3 –º¬≥</i>\n"
        "‚Ä¢ –ü–∞–ª–ª–µ—Ç (–Ω–∞–∏–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–π –≤–∏–¥ —É–ø–∞–∫–æ–≤–∫–∏, –≥—Ä—É–∑ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω –¥–µ—Ä–µ–≤—è–Ω–Ω–æ–π –æ–±—Ä–µ—à–µ—Ç–∫–æ–π) ‚Äì <i>35$/1 –º¬≥</i>\n"
        "‚Ä¢ –î–µ—Ä–µ–≤—è–Ω–Ω—ã–π —è—â–∏–∫ (—Å–∞–º–∞—è –∫—Ä–µ–ø–∫–∞—è —É–ø–∞–∫–æ–≤–∫–∞ –¥–ª—è –ø–µ—Ä–µ–≤–æ–∑–∫–∏ –¥–æ—Ä–æ–≥–∏—Ö, —Ö—Ä—É–ø–∫–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤) ‚Äì <i>100$/1 –º¬≥</i>"
    ),
    "–ë–æ–Ω—É—Å—ã –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏": (
        "üéÅ <b>–ë–æ–Ω—É—Å—ã –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏</b>\n\n"
        "–û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –Ω–∞—à–∏–º–∏ –±–æ–Ω—É—Å–∞–º–∏ –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –µ–∂–µ–º–µ—Å—è—á–Ω–æ–≥–æ –æ–±–æ—Ä–æ—Ç–∞ –∑–∞–∫–∞–∑–∞.\n\n"
        "üìÑ –ù–∏–∂–µ –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º PDF-–¥–æ–∫—É–º–µ–Ω—Ç —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π."
    ),
    "–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤": (
        "üîç <b>–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤</b>\n\n"
        "–ú—ã –ø–æ–¥—Ö–æ–¥–∏–º –∫ –ø–æ–∏—Å–∫—É –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ, –ø–æ—ç—Ç–æ–º—É –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤. –í–æ—Ç —á—Ç–æ –º—ã –¥–µ–ª–∞–µ–º:\n\n"
        "‚Ä¢ –ü—Ä–æ–≤–æ–¥–∏–º –∞–Ω–∞–ª–∏–∑ –¥–µ–ª–æ–≤–æ–π —Ä–µ–ø—É—Ç–∞—Ü–∏–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞.\n"
        "‚Ä¢ –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.\n"
        "‚Ä¢ –û—Ü–µ–Ω–∏–≤–∞–µ–º –æ—Ç–∑—ã–≤—ã –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ –∫–∏—Ç–∞–π—Å–∫–∏—Ö –ø–ª–æ—â–∞–¥–∫–∞—Ö.\n"
        "‚Ä¢ –ò—â–µ–º —Ç–æ–≤–∞—Ä—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–∞—à–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∏ –±—é–¥–∂–µ—Ç–æ–º.\n\n"
        "üíµ –°—Ç–æ–∏–º–æ—Å—Ç—å –æ—Ç <i>3000 —Ä—É–±.</i> –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞.\n"
        "<b>–°—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥–∏ –±—É–¥–µ—Ç –≤—ã—á—Ç–µ–Ω–∞ –∏–∑ —Å—É–º–º—ã –∫–æ–º–∏—Å—Å–∏–∏</b>\n\n"
    ),
    "–ü–æ–∏—Å–∫ —Ñ–∞–±—Ä–∏–∫": (
        "üè≠ <b>–ü–æ–∏—Å–∫ —Ñ–∞–±—Ä–∏–∫</b>\n\n"
        "–ú—ã –ø—Ä–∏–º–µ–Ω—è–µ–º –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:\n\n"
        "‚Ä¢ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–µ–ª–æ–≤—É—é —Ä–µ–ø—É—Ç–∞—Ü–∏—é –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞.\n"
        "‚Ä¢ –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.\n"
        "‚Ä¢ –ò–∑—É—á–∞–µ–º –æ—Ç–∑—ã–≤—ã –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ –∫–∏—Ç–∞–π—Å–∫–∏—Ö –ø–ª–æ—â–∞–¥–∫–∞—Ö.\n"
        "‚Ä¢ –ò—â–µ–º —Ñ–∞–±—Ä–∏–∫–∏ –ø–æ –≤–∞—à–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∏ –±—é–¥–∂–µ—Ç—É.\n\n"
        "üìÅ –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è.\n"
        "üíµ –°—Ç–æ–∏–º–æ—Å—Ç—å –æ—Ç <i>5000 —Ä—É–±.</i> –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞.\n"
        "<b>–°—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥–∏ –±—É–¥–µ—Ç –≤—ã—á—Ç–µ–Ω–∞ –∏–∑ —Å—É–º–º—ã –∫–æ–º–∏—Å—Å–∏–∏</b>\n\n"
    ),
    "–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã —Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–º": (
        "ü§ù <b>–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã —Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–º</b>\n\n"
        "–ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Ç–æ—á–Ω–∏—Ç—å –¥–µ—Ç–∞–ª–∏ —Å–¥–µ–ª–∫–∏, –∑–∞–¥–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ —É–∑–Ω–∞—Ç—å –æ –Ω–∞–ª–∏—á–∏–∏ —Ç–æ–≤–∞—Ä–∞ –∏ —Å—Ä–æ–∫–∞—Ö –¥–æ—Å—Ç–∞–≤–∫–∏ –≤–Ω—É—Ç—Ä–∏ –ö–∏—Ç–∞—è, –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –Ω–∞—à–µ–π —É—Å–ª—É–≥–æ–π –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤.\n\n"
        "–ú—ã —É—Ç–æ—á–Ω–∏–º:\n"
        "‚Ä¢ –£—Å–ª–æ–≤–∏—è —Ä–∞–±–æ—Ç—ã –ø–æ –±—Ä–µ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏—é –∏–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ (OEM/ODM).\n"
        "‚Ä¢ –î–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞—Ö —Ç–æ–≤–∞—Ä–∞.\n"
        "‚Ä¢ –£—Å–ª–æ–≤–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–∫–∏–¥–æ–∫ –ø—Ä–∏ –æ–ø—Ç–æ–≤—ã—Ö –∑–∞–∫—É–ø–∫–∞—Ö.\n"
        "‚Ä¢ –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏ —Å—Ä–æ–∫–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏ –≤–Ω—É—Ç—Ä–∏ –ö–∏—Ç–∞—è.\n"
        "‚Ä¢ –§–æ—Ç–æ- –∏ –≤–∏–¥–µ–æ–º–∞—Ç–µ—Ä–∏–∞–ª—ã —Ç–æ–≤–∞—Ä–∞ –∏ –µ–≥–æ —É–ø–∞–∫–æ–≤–∫–∏.\n"
        "‚Ä¢ –†–∞–∑–º–µ—Ä—ã –∏ –≤–µ—Å —É–ø–∞–∫–æ–≤–æ—á–Ω—ã—Ö –∫–æ—Ä–æ–±–æ–≤.\n"
        "‚Ä¢ –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –Ω–∞–ª–∏—á–∏–∏ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –Ω–∞ —Å–∫–ª–∞–¥–µ.\n"
        "‚Ä¢ –°—Ç–æ–∏–º–æ—Å—Ç—å 1500 —Ä—É–±–ª–µ–π, \n"
        "! –ù–µ –±–æ–ª–µ–µ –¥–≤—É—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤\n"
        "<b>–°—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥–∏ –±—É–¥–µ—Ç –≤—ã—á—Ç–µ–Ω–∞ –∏–∑ —Å—É–º–º—ã –∫–æ–º–∏—Å—Å–∏–∏</b>\n\n"
    ),
    "–î–æ—Å—Ç–∞–≤–∫–∞ –æ–±—Ä–∞–∑—Ü–æ–≤ –≤ –†–§": (
        "‚úàÔ∏è <b>–î–æ—Å—Ç–∞–≤–∫–∞ –æ–±—Ä–∞–∑—Ü–æ–≤ –≤ –†–§</b>\n\n"
        "–ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –Ω–µ–ø—Ä–∏—è—Ç–Ω—ã—Ö —Å—é—Ä–ø—Ä–∏–∑–æ–≤, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∑–∞–∫–∞–∑—ã–≤–∞—Ç—å –æ–±—Ä–∞–∑—Ü—ã —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞—Ä–∞–Ω–µ–µ. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: –¥–æ—Å—Ç–∞–≤–∫–∞ –æ–±—Ä–∞–∑—Ü–æ–≤ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –∞–≤–∏–∞–ø–µ—Ä–µ–≤–æ–∑–∫–æ–π.\n\n"
        "üíµ –°—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥–∏: <i>1500 —Ä—É–±.</i>\n"
        "üì¶ –í —É—Å–ª—É–≥—É –≤—Ö–æ–¥–∏—Ç –¥–æ—Å—Ç–∞–≤–∫–∞ –¥–æ 7 —Ç–æ–≤–∞—Ä–æ–≤ –æ—Ç 7 –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤.\n"
        "üìû –£—Å–ª—É–≥–∞ –æ–±—â–µ–Ω–∏—è —Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–º, –∞ —Ç–∞–∫–∂–µ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ –æ–±–∑–æ—Ä –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ.\n"
        "üîó –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã –º—ã –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä."
    ),
    "–£—Å–ª–æ–≤–∏—è –≤—ã–∫—É–ø–∞ —Ç–æ–≤–∞—Ä–æ–≤": (
        "üíº <b>–£—Å–ª–æ–≤–∏—è –≤—ã–∫—É–ø–∞ —Ç–æ–≤–∞—Ä–æ–≤</b>\n\n"
        "–ö–æ–º–∏—Å—Å–∏—è —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏—Å—Ö–æ–¥—è –∏–∑ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ —Ç–æ–≤–∞—Ä–∞:\n\n"
        "‚Ä¢ 50 000 —Ä—É–± ‚Äì 199 000 —Ä—É–± ‚Äì <i>7%</i>\n"
        "‚Ä¢ 200 000 —Ä—É–± ‚Äì 499 000 —Ä—É–± ‚Äì <i>5%</i>\n"
        "‚Ä¢ 500 000 —Ä—É–± ‚Äì 799 000 —Ä—É–± ‚Äì <i>4%</i>\n"
        "‚Ä¢ 800 000 —Ä—É–± ‚Äì 999 999 —Ä—É–± ‚Äì <i>3%</i>\n"
        "‚Ä¢ –í—ã—à–µ 1 000 000 —Ä—É–± ‚Äì 1 499 000 <i>1,5%</i>\n"
        "‚Ä¢ –°–≤—ã—à–µ 1 500 000 <i>1%</i>\n\n"
        "–í —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–æ–º–∏—Å—Å–∏–∏ –≤—Ö–æ–¥–∏—Ç –æ–±—â–µ–Ω–∏–µ —Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º–∏ (–Ω–µ –±–æ–ª–µ–µ 2, –∫–∞–∂–¥—ã–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ—Å—Ç–∞–≤—â–∏–∫ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –ø–æ –ø—Ä–∞–π—Å—É)."
    ),
    "OEM/ODM - –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ": (
        "üè∑Ô∏è <b>OEM/ODM - –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</b>\n\n"
        "‚Ä¢ <b>OEM</b> ‚Äì –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –≤–∞—à–∏–º –±—Ä–µ–Ω–¥–æ–≤—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ —Ñ–∞–±—Ä–∏–∫–∏.\n"
        "  –ü—Ä–∏–º–µ—Ä: –µ—Å–ª–∏ —Ñ–∞–±—Ä–∏–∫–∞ –≤—ã–ø—É—Å–∫–∞–µ—Ç –±–∞–∑–æ–≤—ã–µ —Ñ—É—Ç–±–æ–ª–∫–∏ —á–µ—Ä–Ω–æ–≥–æ –∏ –±–µ–ª–æ–≥–æ —Ü–≤–µ—Ç–∞, –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–∫–∞–∑–∞—Ç—å –∏—Ö –≤ –∑–µ–ª–µ–Ω–æ–º –∏–ª–∏ –≥–æ–ª—É–±–æ–º —Ü–≤–µ—Ç–µ —Å –≤–∞—à–∏–º –ª–æ–≥–æ—Ç–∏–ø–æ–º.\n"
        "  üíµ –°—Ç–æ–∏–º–æ—Å—Ç—å: –æ—Ç <i>7 —Ç—ã—Å—è—á —Ä—É–±.</i> –∑–∞ —Ç–æ–≤–∞—Ä.\n\n"
        "‚Ä¢ <b>ODM</b> ‚Äì –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –∑–∞–¥–∞–Ω–∏—é –∑–∞–∫–∞–∑—á–∏–∫–∞, —Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–æ–π –¥–∏–∑–∞–π–Ω–∞ –∏ –≤—ã–ø—É—Å–∫–æ–º –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –ø–æ–¥ –≤–∞—à–∏–º –±—Ä–µ–Ω–¥–æ–º.\n"
        "  üíµ –°—Ç–æ–∏–º–æ—Å—Ç—å: –æ—Ç <i>10 —Ç—ã—Å. —Ä—É–±.</i> –∑–∞ —Ç–æ–≤–∞—Ä."
    ),
    "–ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞": (
        "üìî <b>–í —É—Å–ª—É–≥—É –≤—Ö–æ–¥–∏—Ç –æ—Ç—á–µ—Ç —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ:</b>\n\n"
        "–†–µ–π—Ç–∏–Ω–≥–µ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö;\n"
        "–ù–∞–ª–∏—á–∏–∏/–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, —Ä–∞–∑—Ä–µ—à–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤;\n"
        "–û—Å–Ω–æ–≤–Ω–æ–º –≤–∏–¥–µ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å—Ñ–µ—Ä–µ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–ø–æ—Å—Ç–∞–≤—â–∏–∫/—Ñ–∞–±—Ä–∏–∫–∞);\n"
        "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–∞–≤–æ–≤–æ–π —Ñ–æ—Ä–º–µ –∏ —É—á—Ä–µ–¥–∏—Ç–µ–ª–µ;\n"
        "–ù–∞–ª–∏—á–∏–∏/–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å—É–¥–µ–±–Ω—ã—Ö –¥–µ–ª –∏ —à—Ç—Ä–∞—Ñ–æ–≤;\n"
        "–ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –∞–¥—Ä–µ—Å–∞—Ö;\n"
        "–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ-—É—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º –ø–µ—Ä—Å–æ–Ω–∞–ª–µ;\n"
        "–û–±–æ—Ä–æ—Ç–∞—Ö –∫–æ–º–ø–∞–Ω–∏–∏.\n\n"
        "üíµ<b> –°—Ç–æ–∏–º–æ—Å—Ç—å 5 000 —Ä—É–±–ª–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∞ 1-2 –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤.</b>"
    ),
    "–ü–æ–ª–Ω–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏": (
        "<b>–í –¥–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É –≤—Ö–æ–¥–∏—Ç:</b>\n\n"
        "–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞/–ø–æ—Å—Ç–∞–≤—â–∏–∫–∞, –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã, –≤—ã–∫—É–ø, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏.\n"
        "–ó–∞ –≤–∞–º–∏ –∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è –º–µ–Ω–µ–¥–∂–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞—Ç—å –≤–∞—Å –Ω–∞ —ç—Ç–∞–ø–µ –≤–µ–¥–µ–Ω–∏—è —Å–¥–µ–ª–∫–∏.\n\n"
        "üíµ <b>–°—Ç–æ–∏–º–æ—Å—Ç—å 20 000 —Ä—É–±–ª–µ–π –≤ –º–µ—Å—è—Ü.</b>"
    )
}

# Flask –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
@app.route('/')
def webapp():
    return render_template('index.html')

@app.route('/calculate', methods=['POST'])
def calculate_delivery():
    try:
        data = request.json
        logger.info(f"–ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞: {data}")
        
        # –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
        category = data.get('category', '–û–±—ã—á–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã')
        product_cost = float(data.get('product_cost', 0))
        volume = float(data.get('volume', 0))
        weight = float(data.get('weight', 0))
        packaging = data.get('packaging', '–ú–µ—à–æ–∫')
        delivery_speed = data.get('delivery_speed', '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è (15-20 –¥–Ω–µ–π)')
        insurance = data.get('insurance', False)
        unloading = data.get('unloading', False)
        
        # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        if volume <= 0 or weight <= 0:
            return jsonify({'error': '–û–±—ä–µ–º –∏ –≤–µ—Å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –±–æ–ª—å—à–µ 0'}), 400
        
        # –†–∞—Å—á–µ—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏
        density = weight / volume if volume > 0 else 0
        
        # –ë–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ (–ø—Ä–∏–º–µ—Ä–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã)
        base_rates = {
            '–û–±—ã—á–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã': {
                'low_density': 4,  # –¥–æ 200 –∫–≥/–º¬≥
                'medium_density': 6,  # 200-400 –∫–≥/–º¬≥ 
                'high_density': 8   # —Å–≤—ã—à–µ 400 –∫–≥/–º¬≥
            },
            '–û–¥–µ–∂–¥–∞': {
                'low_density': 3,
                'medium_density': 4,
                'high_density': 5
            },
            '–û–±—É–≤—å': {
                'low_density': 5,
                'medium_density': 7,
                'high_density': 9
            }
        }
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∞—Ä–∏—Ñ –ø–æ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏
        if density <= 200:
            rate = base_rates[category]['low_density']
        elif density <= 400:
            rate = base_rates[category]['medium_density']
        else:
            rate = base_rates[category]['high_density']
        
        # –ë–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—ä–µ–º –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞)
        delivery_cost = volume * rate
        
        # –°—Ç–æ–∏–º–æ—Å—Ç—å —É–ø–∞–∫–æ–≤–∫–∏
        packaging_costs = {
            '–ú–µ—à–æ–∫': 5,
            '–ö–∞—Ä—Ç–æ–Ω–Ω—ã–µ —É–≥–æ–ª–∫–∏': volume * 20,  # 6$/0.3–º¬≥ = ~20$/–º¬≥
            '–î–µ—Ä–µ–≤—è–Ω–Ω–∞—è –æ–±—Ä–µ—à–µ—Ç–∫–∞': volume * 27,  # 8$/0.3–º¬≥ = ~27$/–º¬≥
            '–ü–∞–ª–ª–µ—Ç': volume * 35,
            '–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π —è—â–∏–∫': volume * 100
        }
        
        packaging_cost = packaging_costs.get(packaging, 0)
        
        # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–æ—Å—Ç–∞–≤–∫–∏
        speed_multiplier = {
            '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è (15-20 –¥–Ω–µ–π)': 1.0,
            '–£—Å–∫–æ—Ä–µ–Ω–Ω–∞—è (10-12 –¥–Ω–µ–π)': 1.3,
            '–≠–∫—Å–ø—Ä–µ—Å—Å (5-7 –¥–Ω–µ–π)': 1.8
        }
        
        delivery_cost *= speed_multiplier.get(delivery_speed, 1.0)
        
        # –°—Ç—Ä–∞—Ö–æ–≤–∫–∞ (1% –æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞)
        insurance_cost = product_cost * 0.01 if insurance else 0
        
        # –†–∞–∑–≥—Ä—É–∑–∫–∞ (–ø—Ä–∏–º–µ—Ä–Ω–æ 50 —Ä—É–±/–º¬≥)
        unloading_cost = volume * 50 if unloading else 0
        
        # –ö–æ–º–∏—Å—Å–∏—è
        if product_cost < 50000:
            commission_rate = 0.07
        elif product_cost < 200000:
            commission_rate = 0.07
        elif product_cost < 500000:
            commission_rate = 0.05
        elif product_cost < 800000:
            commission_rate = 0.04
        elif product_cost < 1000000:
            commission_rate = 0.03
        elif product_cost < 1500000:
            commission_rate = 0.015
        else:
            commission_rate = 0.01
        
        commission = product_cost * commission_rate
        
        # –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
        total_cost = delivery_cost + packaging_cost + insurance_cost + unloading_cost + commission
        
        result = {
            'delivery_cost': round(delivery_cost, 2),
            'packaging_cost': round(packaging_cost, 2),
            'insurance_cost': round(insurance_cost, 2),
            'unloading_cost': round(unloading_cost, 2),
            'commission': round(commission, 2),
            'total_cost': round(total_cost, 2),
            'density': round(density, 2),
            'commission_rate': f"{commission_rate*100}%"
        }
        
        logger.info(f"–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á–µ—Ç–∞: {result}")
        return jsonify(result)
        
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ: {str(e)}")
        return jsonify({'error': '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏'}), 500

def run_flask():
    port = int(os.environ.get('PORT', 5000))
    app.run(host='0.0.0.0', port=port, debug=False)

def send_main_menu(chat_id):
    webapp_url = 'https://china-level-bot.vercel.app/' 

    bot.send_message(chat_id, "–ö–æ–º–∞–Ω–¥–∞ China level –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –í–∞—Å!\n"
                     "–ë–µ—Ä–µ–º –Ω–∞ —Å–µ–±—è –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ö–∏—Ç–∞–µ–º –æ—Ç –ø–æ–∏—Å–∫–∞ –¥–æ –¥–æ—Å—Ç–∞–≤–∫–∏ –≤ –†–§, –Ω–∞–π–¥–µ–º, –ø—Ä–æ–≤–µ—Ä–∏–º, –≤—ã–∫—É–ø–∏–º –∏ –¥–æ—Å—Ç–∞–≤–∏–º –í–∞—à —Ç–æ–≤–∞—Ä –≤ –†–æ—Å—Å–∏—é.\n\n"
                     "–ü–æ—á–µ–º—É –º—ã?üöÄ\n\n"
                     "üèó–ù–∞—à–∏ —Å–∫–ª–∞–¥—ã —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ 4 –≥–æ—Ä–æ–¥–∞—Ö –ö–∏—Ç–∞—è –∏ –≤ –ú–æ—Å–∫–≤–µ, –æ–±—â–µ–π –ø–ª–æ—â–∞–¥—å—é –±–æ–ª–µ–µ 7,5 —Ç—ã—Å. –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö –º–µ—Ç—Ä–æ–≤\n"
                     "‚≠êÔ∏è–ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ —Å–∫–ª–∞–¥–µ –≤ –ú–æ—Å–∫–≤–µ –¥–æ 1 –º–µ—Å—è—Ü–∞\n"
                     "ü§ù–ó–∞ 7 –ª–µ—Ç —Ä–∞–±–æ—Ç—ã —Å–æ–±—Ä–∞–ª–∏ –±–∞–∑—É –ª—É—á—à–∏—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ —Å–∞–º—ã—Ö —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤\n\n"
                     "–ï—Å–ª–∏ —É –í–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å - –∂–¥–µ–º –≤–∞—à–µ–≥–æ –∑–≤–æ–Ω–∫–∞ –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:\n"
                     "telegram: @ChinaLevelManager\n"
                     "Whatsapp: +7(918)596-31-87\n"
                     "Insta: @china.level -  https://clck.ru/3GKPJE \n"
                     "–ù–∞—à —Å–∞–π—Ç: chinalevel.com\n")

    webapp_keyboard = types.InlineKeyboardMarkup()
    webapp_btn = types.InlineKeyboardButton('üì¶ –¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç', web_app=types.WebAppInfo(url=webapp_url))
    webapp_keyboard.add(webapp_btn)
    
    try:
        bot.send_message(chat_id, "–†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏:", reply_markup=webapp_keyboard)
    except Exception as e:
        logger.error(f"Error sending webapp message: {str(e)}")
        bot.send_message(chat_id, "–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä—É—á–Ω–æ–π —Ä–∞—Å—á–µ—Ç –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º.")

    keyboard1 = types.InlineKeyboardMarkup()
    key_delivery = types.InlineKeyboardButton(text='\U0001F4B0 –°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏–∑ –ö–∏—Ç–∞—è', callback_data='–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏–∑ –ö–∏—Ç–∞—è')
    key_packaging = types.InlineKeyboardButton(text='\U0001F6CD –£–ø–∞–∫–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π', callback_data='–£–ø–∞–∫–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π')
    key_calculator = types.InlineKeyboardButton(text='üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–æ—Å—Ç–∞–≤–∫–∏', web_app=types.WebAppInfo(url=webapp_url))  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à HTTPS URL!
    key_bonuses = types.InlineKeyboardButton(text='üéÅ –ë–æ–Ω—É—Å—ã –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏', callback_data='–ë–æ–Ω—É—Å—ã –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏')
    keyboard1.row(key_delivery)
    keyboard1.row(key_packaging)
    keyboard1.row(key_calculator)
    keyboard1.row(key_bonuses)
    
    try:
        bot.send_message(chat_id, "–û—Å–Ω–æ–≤–Ω—ã–µ —É—Å–ª—É–≥–∏:", reply_markup=keyboard1)
    except Exception as e:
        logger.error(f"Error sending keyboard1: {str(e)}")
        bot.send_message(chat_id, "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —É—Å–ª—É–≥.")

    keyboard2 = types.InlineKeyboardMarkup()
    key_products = types.InlineKeyboardButton(text='\U0001F50D –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤', callback_data='–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤')
    key_supliers = types.InlineKeyboardButton(text='\U0001F3ED –ü–æ–∏—Å–∫ —Ñ–∞–±—Ä–∏–∫', callback_data='–ü–æ–∏—Å–∫ —Ñ–∞–±—Ä–∏–∫')
    key_talks = types.InlineKeyboardButton(text='\U0001F4AC –ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã —Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–º', callback_data='–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã —Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–º')
    key_sample = types.InlineKeyboardButton(text='\U0001F69A –î–æ—Å—Ç–∞–≤–∫–∞ –æ–±—Ä–∞–∑—Ü–æ–≤ –≤ –†–§', callback_data='–î–æ—Å—Ç–∞–≤–∫–∞ –æ–±—Ä–∞–∑—Ü–æ–≤ –≤ –†–§')
    key_ransom = types.InlineKeyboardButton(text='–£—Å–ª–æ–≤–∏—è –≤—ã–∫—É–ø–∞ —Ç–æ–≤–∞—Ä–æ–≤', callback_data='–£—Å–ª–æ–≤–∏—è –≤—ã–∫—É–ø–∞ —Ç–æ–≤–∞—Ä–æ–≤')
    key_manufacturing = types.InlineKeyboardButton(text='\U0001F45A OEM/ODM - –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', callback_data='OEM/ODM - –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ')
    key_check = types.InlineKeyboardButton(text='üîÆ –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞', callback_data='–ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞')
    key_withyou = types.InlineKeyboardButton(text='ü§ù –ü–æ–ª–Ω–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏', callback_data='–ü–æ–ª–Ω–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏')
    keyboard2.row(key_products)
    keyboard2.row(key_supliers)
    keyboard2.row(key_talks)
    keyboard2.row(key_sample)
    keyboard2.row(key_ransom)
    keyboard2.row(key_manufacturing)
    keyboard2.row(key_check)
    keyboard2.row(key_withyou)
    bot.send_message(chat_id, "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏:", reply_markup=keyboard2)

    markup = types.InlineKeyboardMarkup()
    btn_whatsapp = types.InlineKeyboardButton(text='Whats App', url='https://wa.me/qr/55SW5T77PVKLE1')
    btn_telegram = types.InlineKeyboardButton(text='Telegram', url='https://t.me/ChinaLevelManager')
    markup.add(btn_whatsapp)
    markup.add(btn_telegram)
    bot.send_message(chat_id, "–î–ª—è —Å–≤—è–∑–∏ —Å –Ω–∞—à–∏–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º", reply_markup=markup)

@bot.message_handler(commands=['start'])
def start(message):
    bot.send_animation(message.chat.id, animation='https://media.giphy.com/media/wEhdsAyB3Ijza4AL7L/giphy.gif?cid=790b7611h2lw2astv331nd88a0zzol66vu7m835azfytsmvl&ep=v1_gifs_search&rid=giphy.gif&ct=g')
    time.sleep(1)
    send_main_menu(message.chat.id)

@bot.callback_query_handler(func=lambda call: True)
def callback_worker(call):
    logger.info(f"–ü–æ–ª—É—á–µ–Ω callback: {call.data}")

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
    if call.data == "back_to_main":
        logger.info(f"–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ '–ù–∞–∑–∞–¥', —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è ID: {call.message.message_id}")
        try:
            # –£–¥–∞–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (—Å –¥–µ—Ç–∞–ª—è–º–∏ —É—Å–ª—É–≥–∏)
            bot.delete_message(call.message.chat.id, call.message.message_id)
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {str(e)}")
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∑–∞–Ω–æ–≤–æ
        send_main_menu(call.message.chat.id)
        return

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
    if call.data in responses:
        # üåÄ –≠—Ñ—Ñ–µ–∫—Ç "–±–æ—Ç –¥—É–º–∞–µ—Ç"
        bot.send_chat_action(call.message.chat.id, 'typing')
        time.sleep(1.2)

        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–Ω–æ–ø–∫–æ–π "–ù–∞–∑–∞–¥"
        keyboard = types.InlineKeyboardMarkup()
        back_button = types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥", callback_data="back_to_main")
        keyboard.add(back_button)

        # –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        try:
            bot.edit_message_text(chat_id=call.message.chat.id,
                                 message_id=call.message.message_id,
                                 text=responses[call.data],
                                 reply_markup=keyboard)
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {str(e)}")
            bot.send_message(call.message.chat.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.")

        # –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ —Å—Å—ã–ª–∫–∏, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ "–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏–∑ –ö–∏—Ç–∞—è"
        if call.data == "–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏–∑ –ö–∏—Ç–∞—è":
            try:
                # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ —Ñ–∞–π–ª –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏–ª–∏ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
                delivery_price_path = os.path.join(os.path.dirname(__file__), 'delivery_price.xlsx')
                with open(delivery_price_path, 'rb') as file:
                    bot.send_document(chat_id=call.message.chat.id, document=file, caption="–ü—Ä–∞–π—Å-–ª–∏—Å—Ç –Ω–∞ –¥–æ—Å—Ç–∞–≤–∫—É")
            except FileNotFoundError:
                bot.send_message(call.message.chat.id, "–ò–∑–≤–∏–Ω–∏—Ç–µ, —Ñ–∞–π–ª —Å –ø—Ä–∞–π—Å–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω.")
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–∞–π–ª–∞: {str(e)}")

        # –û—Ç–ø—Ä–∞–≤–∫–∞ PDF —Å –±–æ–Ω—É—Å–∞–º–∏ –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏
        if call.data == "–ë–æ–Ω—É—Å—ã –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏":
            try:
                # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å
                bonuses_path = os.path.join(os.path.dirname(__file__), 'privileges.pdf')
                with open(bonuses_path, 'rb') as file:
                    bot.send_document(chat_id=call.message.chat.id, document=file, caption="–ë–æ–Ω—É—Å—ã –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤")
            except FileNotFoundError:
                bot.send_message(call.message.chat.id, "–ò–∑–≤–∏–Ω–∏—Ç–µ, —Ñ–∞–π–ª —Å –±–æ–Ω—É—Å–∞–º–∏ –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω.")
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–∞–π–ª–∞: {str(e)}")
    else:
        logger.warning(f"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π callback: {call.data}")
        bot.send_message(call.message.chat.id, "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞")

if __name__ == '__main__':
    # –ó–∞–ø—É—Å–∫ Flask –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
    flask_thread = threading.Thread(target=run_flask)
    flask_thread.daemon = True
    flask_thread.start()
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    while True:
        try:
            bot.polling(none_stop=True, interval=0)
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –≤ –±–æ—Ç–µ: {str(e)}")
            traceback.print_exc()
            bot.stop_polling()
            time.sleep(15)